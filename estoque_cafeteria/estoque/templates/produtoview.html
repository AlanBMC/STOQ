{% extends 'base.html' %}
{% block title %}Cadastro produto{% endblock %}
{% block content %}
<div class="mt-10 ml-6">
    <button id="openModalBtn" class="bg-color-1 text-color-3  px-6 py-3 rounded-lg m-3 shadow-md hover:bg-opacity-90 transition-all">
        <i class="fas fa-plus mr-2"></i> Criar Produto
    </button>
    <button onclick="abrirModalFornecedor()"  class="bg-color-1 text-color-3 m-3 px-6 py-3 rounded-lg shadow-md hover:bg-opacity-90 transition-all">
        <i class="fas fa-plus mr-2"></i> Cria Fornecedor
        </button>
    <button onclick="abrirModalCategoria()" class="bg-color-1 text-color-3 m-3  px-6 py-3 rounded-lg shadow-md hover:bg-opacity-90 transition-all">
        <i class="fas fa-plus mr-2"></i> Criar Categoria
    </button>
</div>

<!-- Modal (inicialmente oculto) -->
<div id="productModal" class="fixed inset-0 bg-black bg-opacity-50 hidden justify-center items-center z-50">
    <div class="max-w-lg mx-auto bg-color-3 rounded-lg shadow-lg p-6 relative">
        <a id="closeModalBtn" class="absolute top-3 right-3 text-color-4 text-xl">&times;</a>
        
        <h2 class="text-2xl color-5 font-semibold mb-4 color-1">Criar Produto</h2>
        
        <form method="post" action="{% url 'criar_produto'%}">
            {% csrf_token %}
            
            <div class="mb-4">
                <label for="nome" class="block text-color-4 text-sm font-semibold mb-2">Nome do Produto</label>
                <input type="text" id="nome" name="nome" required
                    class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">
            </div>


            <div class="flex space-x-4">
                <!-- Campo de Quantidade -->
                <div class="w-1/2">
                    <label for="quantidade" class="block text-color-4 text-sm font-semibold mb-2">Quantidade</label>
                    <input type="number" id="quantidade" name="quantidade" required step="1" min="1"
                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">
                </div>
            
                <!-- Campo de Tipo de Quantidade -->
                <div class="w-1/2">
                    <label for="tipo_quantidade" class="block text-color-4 text-sm font-semibold mb-2">Tipo de Quantidade</label>
                    <select id="tipo_quantidade" name="tipo_quantidade" required
                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">

                        <option value="UN">Unidade</option>
                        <option value="L">Litro</option>
                        <option value="KG">Quilograma</option>
                        <option value="G">Grama</option>
                        <option value="PCT">Pacote</option>
                    </select>
                </div>
            </div>
            

            <div class="flex space-x-4" style="margin: 5px;">
                <!-- Campo de Quantidade -->
                <div class="w-1/2">
                    <label for="codigo_de_barras" class="block text-color-4 text-sm font-semibold mb-2">Codigo de barras</label>
                    <input type="number"  id="codigo_de_barras" name="codigo_de_barras"  step="1" min="1"
                        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">
                </div>
            
                <!-- Campo de Tipo de Quantidade -->
                <div class="w-1/2">
                    <label for="Status produto" class="block text-color-4 text-sm font-semibold mb-2">Status</label>
                    <select id="status" name="status" required
                            class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">

                        <option value="Em estoque">Em estoque</option>
                        <option value="Em uso">Em uso</option>
                        
                    </select>
                </div>
            </div>
            <div class="mb-4">
                <label for="Validade" class="block text-color-4 text-sm font-semibold mb-2">Validade</label>
                <input type="date" min="{{ today|date:'Y-m-d' }}"  id="validade" name="validade" required
                    class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">
            </div>
            


            <div class="flex space-x-4" style="margin: 5px;">
    
                <!-- Fornecedor -->
                <div class="w-1/2">
                    <label for="Fornecedor" class="block text-color-4 text-sm font-semibold mb-2">Fornecedor</label>
                    <div class="flex items-center space-x-2">
                        <select id="Fornecedor" name="Fornecedor" required
                                class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">
                                {%for fornecedore in fornecedores %}
                                <option value="{{fornecedore.id}}">{{fornecedore.nome}}</option>
                                {% endfor %}
                        </select>
                        
                    </div>
                </div>
                
                <!-- Categoria -->
                <div class="w-1/2">
                    <label for="Categoria" class="block text-color-4 text-sm font-semibold mb-2">Categoria</label>
                    <div class="flex items-center space-x-2">
                        <select id="Categoria" name="Categoria" required
                                class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-color-1">
                            {%for categoria in categorias %}
                            <option value="{{categoria.id}}">{{categoria.nome}}</option>
                            {% endfor %}
                        </select>
                       
                    </div>
                </div>
            </div>
            <button type="submit"
                class="w-full bg-color-1 text-color-3 p-3 rounded-lg hover:bg-opacity-90 transition-all">
                <i class="fas fa-plus-circle mr-2"></i> Adicionar Produto
            </button>
        </form>
    </div>
</div>


<!-- Modal Fornecedor -->
<div id="modalFornecedor" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg w-1/2">
        <h2 class="text-lg font-semibold mb-4">Adicionar Fornecedor</h2>
        <form id="formFornecedor" action="{%url 'criar_fornecedor' %}" method="POST"> {% csrf_token %}
            <div class="mb-4">
                <label class="block text-sm font-medium">Nome do Fornecedor</label>
                <input type="text" name="nome" required
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium">Telefone</label>
                <input type="tel" name="contato" required
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>
            <button type="submit" class="w-full  py-2 rounded-lg ">
                Salvar
            </button>
        </form>
    </div>
</div>

<!-- Modal Categoria -->
<div id="modalCategoria" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg w-1/2">
        <h2 class="text-lg font-semibold mb-4">Adicionar Categoria</h2>
        <form id="formCategoria" action="{% url 'criar_categoria' %}" method="POST"> {% csrf_token %}
            <div class="mb-4">
                <label class="block text-sm font-medium">Nome da Categoria</label>
                <input type="text" name="nomeCategoria" required
                       class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button type="submit" class="w-full  py-2 rounded-lg ">
                Salvar
            </button>
        </form>
    </div>
</div>

<script>
    const openModalBtn = document.getElementById('openModalBtn');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const modal = document.getElementById('productModal');

    // Abre o modal
    openModalBtn.addEventListener('click', () => {
        modal.classList.remove('hidden');
        modal.classList.add('flex');
    });

    // Fecha o modal ao clicar no botão de fechar
    closeModalBtn.addEventListener('click', () => {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
    });

    // Fecha o modal ao clicar fora do conteúdo
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
    });

    function abrirModalFornecedor() {
    document.getElementById('modalFornecedor').classList.remove('hidden');
}

function abrirModalCategoria() {
    document.getElementById('modalCategoria').classList.remove('hidden');
}

// Fechar modal ao clicar fora do formulário
window.onclick = function(event) {
    let modalFornecedor = document.getElementById('modalFornecedor');
    let modalCategoria = document.getElementById('modalCategoria');
    
    if (event.target == modalFornecedor) {
        modalFornecedor.classList.add('hidden');
    }
    if (event.target == modalCategoria) {
        modalCategoria.classList.add('hidden');
    }
}
</script>
{% endblock %}
